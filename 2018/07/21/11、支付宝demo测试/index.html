<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 11、支付宝demo测试 · Eureka-Home</title><meta name="description" content="11、支付宝demo测试 - Eureka"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Eureka-Home"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">11、支付宝demo测试</h1><div class="post-info">Jul 21, 2018</div><div class="post-content"><p>支付宝demo测试<br><a id="more"></a></p>
<ul>
<li>1、沙箱登陆：<a href="https://openhome.alipay.com/platform/appDaily.htm?tab=info" target="_blank" rel="noopener">https://openhome.alipay.com/platform/appDaily.htm?tab=info</a></li>
<li>2、沙箱环境使用说明：<a href="https://docs.open.alipay.com/200/105311/" target="_blank" rel="noopener">https://docs.open.alipay.com/200/105311/</a></li>
<li>3、如何使用沙箱环境：<a href="https://support.open.alipay.com/support/hotProblemDetail.htm?spm=a219a.7386797.0.0.YhIJho&amp;source=search&amp;id=251932" target="_blank" rel="noopener">https://support.open.alipay.com/support/hotProblemDetail.htm?spm=a219a.7386797.0.0.YhIJho&amp;source=search&amp;id=251932</a></li>
<li>4、当面付产品介绍：<a href="https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.5HYMFg&amp;treeId=193&amp;articleId=105072&amp;docType=1" target="_blank" rel="noopener">https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.5HYMFg&amp;treeId=193&amp;articleId=105072&amp;docType=1</a></li>
<li>5、扫码支付接入指引：<a href="https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.eZzwyB&amp;treeId=193&amp;articleId=106078&amp;docType=1" target="_blank" rel="noopener">https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.eZzwyB&amp;treeId=193&amp;articleId=106078&amp;docType=1</a></li>
<li>6、当面付快速接入：<a href="https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.k84ZRs&amp;treeId=193&amp;articleId=105170&amp;docType=1" target="_blank" rel="noopener">https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.k84ZRs&amp;treeId=193&amp;articleId=105170&amp;docType=1</a></li>
<li>7、当面付接入必读：<a href="https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.UUf8nV&amp;treeId=193&amp;articleId=105322&amp;docType=1" target="_blank" rel="noopener">https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.UUf8nV&amp;treeId=193&amp;articleId=105322&amp;docType=1</a></li>
<li>8、当面付进阶功能：<a href="https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.DdxGEd&amp;treeId=193&amp;articleId=105190&amp;docType=1" target="_blank" rel="noopener">https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.DdxGEd&amp;treeId=193&amp;articleId=105190&amp;docType=1</a></li>
<li>9、当面付异步通知-仅用于扫码支付：<a href="https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.Bj6VoE&amp;treeId=193&amp;articleId=103296&amp;docType=1" target="_blank" rel="noopener">https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.Bj6VoE&amp;treeId=193&amp;articleId=103296&amp;docType=1</a></li>
<li>10、当面付SDK&amp;Demo：<a href="https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.B4OyFM&amp;treeId=193&amp;articleId=105201&amp;docType=1" target="_blank" rel="noopener">https://support.open.alipay.com/docs/doc.htm?spm=a219a.7629140.0.0.B4OyFM&amp;treeId=193&amp;articleId=105201&amp;docType=1</a></li>
<li>11、服务端SDK：<a href="https://docs.open.alipay.com/54/103419" target="_blank" rel="noopener">https://docs.open.alipay.com/54/103419</a></li>
<li>12、生成RSA密钥：<a href="https://docs.open.alipay.com/291/105971" target="_blank" rel="noopener">https://docs.open.alipay.com/291/105971</a></li>
<li>13、创建应用：<a href="https://docs.open.alipay.com/200/105310" target="_blank" rel="noopener">https://docs.open.alipay.com/200/105310</a></li>
<li>14、签名验签工具：<a href="https://openclub.alipay.com/read.php?tid=955&amp;fid=46" target="_blank" rel="noopener">https://openclub.alipay.com/read.php?tid=955&amp;fid=46</a></li>
</ul>
<h3 id="支付宝Demo演示"><a href="#支付宝Demo演示" class="headerlink" title="支付宝Demo演示"></a>支付宝Demo演示</h3><ul>
<li>下载支付宝的当面付demo: <a href="https://docs.open.alipay.com/54/104506/" target="_blank" rel="noopener">https://docs.open.alipay.com/54/104506/</a></li>
<li>用Idea引入TradePayDemo这个项目</li>
<li>直接运行Main.java是报错的，我们需要配置zfbinfo.properties文件</li>
</ul>
<h5 id="1-第一个配置支付宝网关即可："><a href="#1-第一个配置支付宝网关即可：" class="headerlink" title="1. 第一个配置支付宝网关即可："></a>1. 第一个配置支付宝网关即可：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open_api_domain = https://openapi.alipaydev.com/gateway.do</span><br></pre></td></tr></table></figure>
<h5 id="2-第二行的配置不变："><a href="#2-第二行的配置不变：" class="headerlink" title="2. 第二行的配置不变："></a>2. 第二行的配置不变：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mcloud_api_domain = http://mcloudmonitor.com/gateway.do</span><br></pre></td></tr></table></figure>
<h5 id="3-pid配置就是登陆支付宝沙箱环境之后的-商户UID"><a href="#3-pid配置就是登陆支付宝沙箱环境之后的-商户UID" class="headerlink" title="3. pid配置就是登陆支付宝沙箱环境之后的 商户UID"></a>3. pid配置就是登陆支付宝沙箱环境之后的 商户UID</h5><h5 id="4-appid就是对应的APPID"><a href="#4-appid就是对应的APPID" class="headerlink" title="4. appid就是对应的APPID"></a>4. appid就是对应的APPID</h5><h5 id="5-RSA私钥、公钥和支付宝公钥的配置"><a href="#5-RSA私钥、公钥和支付宝公钥的配置" class="headerlink" title="5. RSA私钥、公钥和支付宝公钥的配置"></a>5. RSA私钥、公钥和支付宝公钥的配置</h5><ul>
<li>首先需要去下载支付宝的RSA验签工具，见链接14。</li>
<li>下载对应系统的软件，解压。</li>
<li>windows下直接运行 RSA签名验签工具.bat ，直接生成即可。</li>
<li>将私钥放在private_key，公钥放在public_key。</li>
</ul>
<h5 id="6-SHA256withRsa对应支付宝公钥的配置"><a href="#6-SHA256withRsa对应支付宝公钥的配置" class="headerlink" title="6. #SHA256withRsa对应支付宝公钥的配置"></a>6. #SHA256withRsa对应支付宝公钥的配置</h5><p>将上面生成的公钥放在RSA2(SHA256)密钥(推荐)中，页面刷新，会出现一个 查看支付宝公钥，将其打开复制放到这里来即可。</p>
<h5 id="7-运行主函数，会出现以下结果："><a href="#7-运行主函数，会出现以下结果：" class="headerlink" title="7. 运行主函数，会出现以下结果："></a>7. 运行主函数，会出现以下结果：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">一月 06, 2018 10:43:37 上午 com.alipay.demo.trade.config.Configs init</span><br><span class="line">信息: 配置文件名: zfbinfo.properties</span><br><span class="line">一月 06, 2018 10:43:37 上午 com.alipay.demo.trade.config.Configs init</span><br><span class="line">信息: Configs&#123;支付宝openapi网关: https://openapi.alipaydev.com/gateway.do</span><br><span class="line">, 支付宝mcloudapi网关域名: http://mcloudmonitor.com/gateway.do</span><br><span class="line">, pid: 2088102172437193</span><br><span class="line">, appid: 2016082100306095</span><br><span class="line">, 商户RSA私钥: MIIEvQ******dKWxg=</span><br><span class="line">, 商户RSA公钥: MIIBIj******IDAQAB</span><br><span class="line">, 支付宝RSA公钥: MIIBIj******IDAQAB</span><br><span class="line">, 签名类型: RSA2</span><br><span class="line">, 查询重试次数: 5</span><br><span class="line">, 查询间隔(毫秒): 5000</span><br><span class="line">, 撤销尝试次数: 3</span><br><span class="line">, 撤销重试间隔(毫秒): 2000</span><br><span class="line">, 交易保障调度延迟(秒): 5</span><br><span class="line">, 交易保障调度间隔(秒): 900</span><br><span class="line">&#125;</span><br><span class="line">一月 06, 2018 10:43:37 上午 com.alipay.demo.trade.service.impl.AbsAlipayTradeService tradePrecreate</span><br><span class="line">信息: trade.precreate bizContent:</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">    &quot;out_trade_no&quot;: &quot;tradeprecreate15152066176329550113&quot;,</span><br><span class="line">    &quot;seller_id&quot;: &quot;&quot;,</span><br><span class="line">    &quot;total_amount&quot;: &quot;0.01&quot;,</span><br><span class="line">    &quot;undiscountable_amount&quot;: &quot;0&quot;,</span><br><span class="line">    &quot;subject&quot;: &quot;xxx品牌xxx门店当面付扫码消费&quot;,</span><br><span class="line">    &quot;body&quot;: &quot;购买商品3件共20.00元&quot;,</span><br><span class="line">    &quot;goods_detail&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">    &quot;goods_id&quot;: &quot;goods_id001&quot;,</span><br><span class="line">    &quot;goods_name&quot;: &quot;xxx小面包&quot;,</span><br><span class="line">    &quot;quantity&quot;: 1,</span><br><span class="line">    &quot;price&quot;: &quot;10&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">    &quot;goods_id&quot;: &quot;goods_id002&quot;,</span><br><span class="line">    &quot;goods_name&quot;: &quot;xxx牙刷&quot;,</span><br><span class="line">    &quot;quantity&quot;: 2,</span><br><span class="line">    &quot;price&quot;: &quot;5&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;operator_id&quot;: &quot;test_operator_id&quot;,</span><br><span class="line">    &quot;store_id&quot;: &quot;test_store_id&quot;,</span><br><span class="line">    &quot;extend_params&quot;: &#123;</span><br><span class="line">    &quot;sys_service_provider_id&quot;: &quot;2088100200300400500&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;timeout_express&quot;: &quot;120m&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">一月 06, 2018 10:43:40 上午 com.alipay.demo.trade.service.impl.AbsAlipayService getResponse</span><br><span class="line">信息: </span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">    &quot;alipay_trade_precreate_response&quot;: &#123;</span><br><span class="line">    &quot;code&quot;: &quot;10000&quot;,</span><br><span class="line">    &quot;msg&quot;: &quot;Success&quot;,</span><br><span class="line">    &quot;out_trade_no&quot;: &quot;tradeprecreate15152066176329550113&quot;,</span><br><span class="line">    &quot;qr_code&quot;: &quot;https://qr.alipay.com/bax06399mdoc95eqlnpk0016&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;sign&quot;: &quot;F63Q9zK0fd0cXUkONm7TcH+1fZgblj2e7GD8p70h0YcgfOPjt0zQktDiCRwljEesGbK2hvS+9gn0ucJP+W6zoBpyABJFcghvrwRF7CPfOPsD9HDqK7FRYGS9siWhQK7jtpRf/vREvg/XTck/gbK1gpjAAi50IJEA2vfppPmiSDuY/e1Jw+0xMiQzXtcRpEO727XkJHmHiSI9VqlilxvdC9hj+u1qXhmNqkFzJG2z3Qc32jwQrPeLIXzT0JgVeTGTVcMB3Mp1501TrbFJTpA7h9QNKBFa0YKBSS6feKrQBz2+OPJ0gAoweBZ4AaCWo/tMhgx164/hNQSvn3IcG9HcdA==&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">一月 06, 2018 10:43:40 上午 com.alipay.demo.trade.Main test_trade_precreate</span><br><span class="line">信息: 支付宝预下单成功: )</span><br><span class="line">一月 06, 2018 10:43:40 上午 com.alipay.demo.trade.Main dumpResponse</span><br><span class="line">信息: code:10000, msg:Success</span><br><span class="line">一月 06, 2018 10:43:40 上午 com.alipay.demo.trade.Main dumpResponse</span><br><span class="line">信息: body:&#123;&quot;alipay_trade_precreate_response&quot;:&#123;&quot;code&quot;:&quot;10000&quot;,&quot;msg&quot;:&quot;Success&quot;,&quot;out_trade_no&quot;:&quot;tradeprecreate15152066176329550113&quot;,&quot;qr_code&quot;:&quot;https:\/\/qr.alipay.com\/bax06399mdoc95eqlnpk0016&quot;&#125;,&quot;sign&quot;:&quot;F63Q9zK0fd0cXUkONm7TcH+1fZgblj2e7GD8p70h0YcgfOPjt0zQktDiCRwljEesGbK2hvS+9gn0ucJP+W6zoBpyABJFcghvrwRF7CPfOPsD9HDqK7FRYGS9siWhQK7jtpRf/vREvg/XTck/gbK1gpjAAi50IJEA2vfppPmiSDuY/e1Jw+0xMiQzXtcRpEO727XkJHmHiSI9VqlilxvdC9hj+u1qXhmNqkFzJG2z3Qc32jwQrPeLIXzT0JgVeTGTVcMB3Mp1501TrbFJTpA7h9QNKBFa0YKBSS6feKrQBz2+OPJ0gAoweBZ4AaCWo/tMhgx164/hNQSvn3IcG9HcdA==&quot;&#125;</span><br><span class="line">一月 06, 2018 10:43:40 上午 com.alipay.demo.trade.Main test_trade_precreate</span><br><span class="line">信息: filePath:/Users/sudo/Desktop/qr-tradeprecreate15152066176329550113.png</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在第二段格式化的json数据中有一个 “qr_code”: “<a href="https://qr.alipay.com/bax06399mdoc95eqlnpk0016&quot;" target="_blank" rel="noopener">https://qr.alipay.com/bax06399mdoc95eqlnpk0016&quot;</a> ，这就是支付宝生成的付款二维码。</p>
</blockquote>
<blockquote>
<p>我们将其复制到二维码生成工具中，即可生成一个二维码，用支付宝沙箱app扫码即可完成支付测试。</p>
</blockquote>
<h5 id="8、server运行"><a href="#8、server运行" class="headerlink" title="8、server运行"></a>8、server运行</h5><p>因为本身的demo就是一个web项目，所以配置tomcat即可运行。如果发现不能找到 artifact，需要在 Project Structure 中配置一下artifacts。运行起来就可以模拟支付了。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/07/21/12.@PostConstruct&amp;@PreDestory/" class="prev">上一篇</a><a href="/2018/07/21/11、LinkedHashSet源码解析/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2019 <a href="http://yoursite.com">Eureka</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>