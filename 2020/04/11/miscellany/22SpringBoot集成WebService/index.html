<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> SpringBoot集成WebService · fossi</title><meta name="description" content="SpringBoot集成WebService - fossi"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">首页</a></li><li class="nav-list-item"><a href="https://sunweiguo.github.io/tags/" target="_blank" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="http://bloghello.oursnail.cn/test.html" target="_blank" class="nav-list-link">爱情</a></li><li class="nav-list-item"><a href="https://github.com/sunweiguo" target="_blank" class="nav-list-link">GIT</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">SpringBoot集成WebService</h1><div class="post-meta"><span class="post-time">Apr 11, 2020</span></div><div class="post-content"><p>由于项目要用到webservice，我自己用springboot来整合试了下，遂有了下述的记录。</p>
<a id="more"></a>
<h2>1.什么是webservice</h2>
<p>简单来说,<code>webservice</code>就是远程调用技术,也叫<code>XML Web Service</code>. <code>WebService</code>是一种可以接收从<code>Internet</code>或者<code>Intranet上</code>的其它系统中传递过来的请求，轻量级的独立的通讯技术。。</p>
<p>XML：(<code>Extensible Markup Language</code>)扩展型可标记语言。面向短期的临时数据处理、面向万维网络，是SOAP的基础。</p>
<p>SOAP：(<code>Simple Object Access Protocol</code>)简单对象存取协议。是<code>XML Web Service</code> 的通信协议。当用户通过UDDI找到你的WSDL描述文档后，他通过可以SOAP调用你建立的Web服务中的一个或多个操作。SOAP是XML文档形式的调用方法的规范，它可以支持不同的底层接口，像HTTP(S)或者SMTP。</p>
<p>WSDL：(<code>Web Services Description Language</code>) WSDL 文件是一个 XML 文档，用于说明一组 SOAP 消息以及如何交换这些消息。大多数情况下由软件自动生成和使用。</p>
<p>我们一般是在具体平台开发 webservice 接口，以及调用 webservice 接口，每种开发语言都有自己的 webservice 实现框架。比如 Java 就有 Apache Axis1、Apache Axis2、Codehaus XFire、Apache CXF、Apache Wink、Jboss RESTEasyd 等等。其中 Apache CXF 用的比较多，它也可以和 Spring Boot 整合。</p>
<h2>2、集成webservice</h2>
<p>1、新建一个<code>springboot</code>项目，引入相关依赖：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-web-services&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;cxf-rt-frontend-jaxws&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.1.6&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;cxf-rt-transports-http&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.1.6&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--lombok--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">    &lt;optional&gt;true&lt;/optional&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>2、服务端接口定义</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 本地访问的地址为：http://localhost:8088/ContentDeployResult</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebService</span>(name = <span class="string">"ContentDeployResult"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CDNResponse</span> </span>&#123;</span><br><span class="line">    <span class="meta">@WebMethod</span></span><br><span class="line">    <span class="function">CommonXmlResponse <span class="title">ContentDeployResult</span><span class="params">(@WebParam(name = <span class="string">"CMSID"</span>, targetNamespace = <span class="string">"iptv"</span>)</span> String CMSID,</span></span><br><span class="line"><span class="function">                                          @<span class="title">WebParam</span><span class="params">(name = <span class="string">"SOPID"</span>, targetNamespace = <span class="string">"iptv"</span>)</span> String SOPID,</span></span><br><span class="line"><span class="function">                                          @<span class="title">WebParam</span><span class="params">(name = <span class="string">"CorrelateID"</span>, targetNamespace = <span class="string">"iptv"</span>)</span> String CorrelateID,</span></span><br><span class="line"><span class="function">                                          @<span class="title">WebParam</span><span class="params">(name = <span class="string">"ResultCode"</span>, targetNamespace = <span class="string">"iptv"</span>)</span> Integer ResultCode,</span></span><br><span class="line"><span class="function">                                          @<span class="title">WebParam</span><span class="params">(name = <span class="string">"ErrorDescription"</span>, targetNamespace = <span class="string">"iptv"</span>)</span> String ErrorDescription,</span></span><br><span class="line"><span class="function">                                          @<span class="title">WebParam</span><span class="params">(name = <span class="string">"ResultFileURL"</span>, targetNamespace = <span class="string">"iptv"</span>)</span> String ResultFileURL,</span></span><br><span class="line"><span class="function">                                          @<span class="title">WebParam</span><span class="params">(name = <span class="string">"XMLURLQC"</span>, targetNamespace = <span class="string">"iptv"</span>)</span> String XMLURLQC, <span class="comment">//xml MD5摘要</span></span></span><br><span class="line"><span class="function">                                          @<span class="title">WebParam</span><span class="params">(name = <span class="string">"Encrypt"</span>, targetNamespace = <span class="string">"iptv"</span>)</span> String Encrypt)</span>; <span class="comment">//加密校验字符串// );</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、服务端接口的实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CDNResponseImpl</span> <span class="keyword">implements</span> <span class="title">CDNResponse</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonXmlResponse <span class="title">ContentDeployResult</span><span class="params">(String CMSID,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                 String SOPID,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                 String CorrelateID,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                 Integer ResultCode,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                 String ErrorDescription,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                 String ResultFileURL,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                 String XMLURLQC,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                 String Encrypt)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1、封装传递进来的参数</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、对参数进行校验</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3、处理CDN回调的逻辑</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4、cxf 服务配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhjt.cms.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zhjt.cms.intf.webservice.cdn.CDNResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.cxf.Bus;</span><br><span class="line"><span class="keyword">import</span> org.apache.cxf.bus.spring.SpringBus;</span><br><span class="line"><span class="keyword">import</span> org.apache.cxf.jaxws.EndpointImpl;</span><br><span class="line"><span class="keyword">import</span> org.apache.cxf.transport.servlet.CXFServlet;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.ServletRegistrationBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.ws.Endpoint;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CxfConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CDNResponse cdnResponse;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注入servlet  bean name不能dispatcherServlet 否则会覆盖dispatcherServlet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(name = <span class="string">"cxfServlet"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean&lt;CXFServlet&gt; <span class="title">cxfServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ServletRegistrationBean&lt;&gt;(<span class="keyword">new</span> CXFServlet(),<span class="string">"/*"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(name = Bus.DEFAULT_BUS_ID)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> SpringBus <span class="title">springBus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SpringBus();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册WebServiceDemoService接口到webservice服务</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(name = <span class="string">"ContentDeployResult"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Endpoint <span class="title">sweptPayEndpoint</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        EndpointImpl endpoint = <span class="keyword">new</span> EndpointImpl(springBus(), cdnResponse);</span><br><span class="line">        endpoint.publish(<span class="string">"/ContentDeployResult"</span>);</span><br><span class="line">        <span class="keyword">return</span> endpoint;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5、启动项目，用soapui来模拟请求即可。</p>
</div></article></div></section><footer><div class="paginator"><a href="/2020/03/01/leetcode-array/leetcode-035-使用最小花费爬楼梯/" class="next">NEXT</a></div><div id="container"></div><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script><script>var gitment = new Gitment({
    id: 'Sat Apr 11 2020 22:00:15 GMT+0800',
    owner: 'sunweiguo',
    repo: 'sunweiguo.github.io',
    oauth: {
        client_id: '56c422eddebac740f021',
        client_secret: 'b0520b7f71d5d883e029133f06c3328e3d3168e1',
    },
})
gitment.render('container')</script><div class="copyright"><p>© 2019 - 2020 <a href="http://yoursite.com">fossi</a>,苏ICP备17064972号.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-134836068-1",'auto');ga('send','pageview');</script><script src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>